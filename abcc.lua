MoveAbsJ("R_DR6",K200,v10,z10,tool0,wobj0,load0)
MoveAbsJ("R_DL6",K290,v10,z10,tool0,wobj0,load0)

--offscount.num=0

--MoveAbsJ("R_DL6",K90,v2000,z10,tool0,wobj0,load0)
--MoveAbsJ("R_DR6",K100,v2000,z10,tool0,wobj0,load0)

local receivedData = nil
local content = nil
--string split
function split(input, delimiter)
    if type(delimiter) ~= "string" or #delimiter <= 0 then
        return
    end
    local start = 1
    local array = {}
    while true do
        local pos = string.find(input, delimiter, start, true)
        if not pos then
            break
        end
        table.insert (array, string.sub (input, start, pos - 1))
        start = pos + string.len (delimiter)
    end
    table.insert (array, string.sub (input, start))
    return array
end
function Receive()

-- body
end

function Send( )
retVal = SocketSend(socketName, "ready", 2000)
	if retVal ~= 1 then
		TPWrite(string.format("Send failed: %d.", retVal))
		return
	end
end
require "SocketApi"

local socketName = "sock1"
local retVal = false
local receivedData = nil

TPWrite("--SocketClient --")
SocketDisconnect(socketName)
Sleep(500)
retVal = SocketConnect(socketName, "192.168.89.122", 8887)
if retVal == 1 then
	TPWrite("Connect successfully")
else
	TPWrite("Connect failed")
	return
end
Sleep(300)
while(1)do
    retVal, receivedData = SocketReceive(socketName, 0)
    if retVal ~= 1 then
        TPWrite(string.format("Received failed: %d.", retVal))
        Stop()
        return
    end
    TPWrite("Received data: " .. receivedData)
--Line
--MoveAbsJ("R_DR6",K290,v2000,z10,tool0,wobj0,load0)
--MoveAbsJ("R_DR6",K300,v2000,z10,tool0,wobj0,load0)
MoveAbsJ("R_DL6",K280,v2000,fine,tool0,wobj0,load0)
MoveL("R_DL6",P90,v2000,fine,tool0,wobj0,load0)
--MoveL("R_DL6",P80,v2000,fine,tool0,wobj0,load0)
--MoveL("R_DL6",P70,v2000,fine,tool0,wobj0,load0)
--MoveL("R_DL6",P60,v2000,fine,tool0,wobj0,load0)

MoveAbsJ("R_DL6",K290,v2000,fine,tool0,wobj0,load0)



--MoveAbsJ("R_DR6",K290,v2000,z10,tool0,wobj0,load0)
--MoveAbsJ("R_DR6",K330,Vmax,z10,tool0,wobj0,load0)


--Broken-Line
--MoveAbsJ("R_DL6",K280,v2000,z10,tool0,wobj0,load0)
--MoveAbsJ("R_DL6",K340,v2000,z10,tool0,wobj0,load0)
--MoveL("R_DL6",P90,v2000,z10,tool0,wobj0,load0)
--MoveL("R_DL6",P110,v2000,z10,tool0,wobj0,load0)
--MoveAbsJ("R_DL6",K280,v2000,z10,tool0,wobj0,load0)

--arc
--MoveL(P10,v200,fine,tool1,wobj1)
--MoveC(P20,P30,v200,z10,tool1,wobj1)



function fun1()
MoveAbsJ("R_DR6",K200,v2000,z10,tool0,wobj0,load0)
end
function fun2()
MoveAbsJ("R_DL6",K290,v2000,z10,tool0,wobj0,load0)
end
SyncExecute(fun1,fun2)

Stop()
end


local function GLOBALDATA_DEFINE()
TOOLDATA("tool1",true,{{0.000,0.000,0.000},{1.000000,0.000000,0.000000,0.000000}},{0.00,{0.00,0.00,0.00},{1.000000,0.000000,0.000000,0.000000},0.00,0.00,0.00,0.00,0.00,0.00})
WOBJDATA("wobj1",false,true,"",{{0.000,0.000,0.000},{1.000000,0.000000,0.000000,0.000000}},{{0.000,0.000,0.000},{1.000000,0.000000,0.000000,0.000000}})
JOINTTARGET("K10",{-1.041,17.246,-95.124,75.877,56.792,59.766,0.000},{0.000,0.000,0.000,0.000,0.000,0.000,0.000})
JOINTTARGET("K100",{-119.903,27.822,-94.927,62.845,82.280,24.423,0.000},{0.000,0.000,0.000,0.000,0.000,0.000,0.000})
JOINTTARGET("K110",{-119.904,27.821,-94.927,62.845,82.281,24.427,0.000},{0.000,0.000,0.000,0.000,0.000,0.000,0.000})
JOINTTARGET("K120",{12.296,-2.639,-83.708,-6.198,90.806,59.794,0.000},{0.000,0.000,0.000,0.000,0.000,0.000,0.000})
JOINTTARGET("K130",{14.953,16.792,-98.718,-8.853,90.842,62.451,0.000},{0.000,0.000,0.000,0.000,0.000,0.000,0.000})
JOINTTARGET("K140",{14.965,35.562,-109.374,-21.352,93.758,62.453,0.000},{0.000,0.000,0.000,0.000,0.000,0.000,0.000})
JOINTTARGET("K150",{-133.441,-41.675,-50.341,2.651,81.390,20.068,0.000},{0.000,0.000,0.000,0.000,0.000,0.000,0.000})
JOINTTARGET("K160",{-141.865,-27.639,-59.768,56.033,79.170,21.434,0.000},{0.000,0.000,0.000,0.000,0.000,0.000,0.000})
JOINTTARGET("K170",{-144.463,-25.225,-63.405,57.486,81.392,20.068,0.000},{0.000,0.000,0.000,0.000,0.000,0.000,0.000})
JOINTTARGET("K180",{-144.465,-25.227,-63.408,57.485,81.392,20.068,0.000},{0.000,0.000,0.000,0.000,0.000,0.000,0.000})
JOINTTARGET("K190",{-136.043,28.272,-139.946,107.414,82.252,24.414,0.000},{0.000,0.000,0.000,0.000,0.000,0.000,0.000})
JOINTTARGET("K20",{18.031,17.246,-95.124,75.876,47.407,59.766,0.000},{0.000,0.000,0.000,0.000,0.000,0.000,0.000})
JOINTTARGET("K200",{-51.025,56.939,-138.496,31.549,102.208,-7.026,0.000},{0.000,0.000,0.000,0.000,0.000,0.000,0.000})
JOINTTARGET("K210",{-105.793,-11.037,-108.445,32.035,86.891,75.642,0.000},{0.000,0.000,0.000,0.000,0.000,0.000,0.000})
JOINTTARGET("K220",{16.090,-9.339,-92.262,18.613,96.043,47.366,0.000},{0.000,0.000,0.000,0.000,0.000,0.000,0.000})
JOINTTARGET("K230",{-2.144,-16.013,-80.658,9.709,87.738,51.814,0.000},{0.000,0.000,0.000,0.000,0.000,0.000,0.000})
JOINTTARGET("K240",{-4.925,-8.832,-89.587,11.565,87.887,49.034,0.000},{0.000,0.000,0.000,0.000,0.000,0.000,0.000})
JOINTTARGET("K250",{-6.596,-9.797,-88.469,11.470,87.980,47.366,0.000},{0.000,0.000,0.000,0.000,0.000,0.000,0.000})
JOINTTARGET("K260",{-160.136,-20.597,-65.023,2.745,81.340,20.052,0.000},{0.000,0.000,0.000,0.000,0.000,0.000,0.000})
JOINTTARGET("K270",{-1.047,12.908,-129.069,114.166,56.752,59.727,0.000},{0.000,0.000,0.000,0.000,0.000,0.000,0.000})
JOINTTARGET("K280",{50.938,19.937,123.387,-82.167,-110.264,29.178,0.000},{0.000,0.000,0.000,0.000,0.000,0.000,0.000})
JOINTTARGET("K290",{-67.270,37.505,-127.838,6.959,51.350,59.810,0.000},{0.000,0.000,0.000,0.000,0.000,0.000,0.000})
JOINTTARGET("K30",{-119.925,27.828,-94.946,62.858,82.297,24.430,0.000},{0.000,0.000,0.000,0.000,0.000,0.000,0.000})
JOINTTARGET("K300",{-119.690,-0.432,-153.037,102.138,86.913,21.045,0.000},{0.000,0.000,0.000,0.000,0.000,0.000,0.000})
JOINTTARGET("K310",{19.334,-0.459,-154.992,92.892,44.905,46.758,0.000},{0.000,0.000,0.000,0.000,0.000,0.000,0.000})
JOINTTARGET("K320",{-17.408,-18.259,-141.621,117.407,68.099,11.854,0.000},{0.000,0.000,0.000,0.000,0.000,0.000,0.000})
JOINTTARGET("K330",{-138.230,-1.862,-146.185,89.791,103.757,4.913,0.000},{0.000,0.000,0.000,0.000,0.000,0.000,0.000})
JOINTTARGET("K340",{5.575,-8.523,-139.221,71.596,42.681,99.148,0.000},{0.000,0.000,0.000,0.000,0.000,0.000,0.000})
JOINTTARGET("K40",{-144.362,27.828,-94.945,62.857,82.298,24.430,0.000},{0.000,0.000,0.000,0.000,0.000,0.000,0.000})
JOINTTARGET("K50",{-136.095,28.285,-139.998,107.455,82.281,24.427,0.000},{0.000,0.000,0.000,0.000,0.000,0.000,0.000})
JOINTTARGET("K60",{-1.044,12.910,-129.120,114.212,56.779,59.753,0.000},{0.000,0.000,0.000,0.000,0.000,0.000,0.000})
JOINTTARGET("K70",{-136.070,28.277,-139.972,107.435,82.266,24.420,0.000},{0.000,0.000,0.000,0.000,0.000,0.000,0.000})
JOINTTARGET("K80",{-1.044,12.909,-129.096,114.190,56.766,59.741,0.000},{0.000,0.000,0.000,0.000,0.000,0.000,0.000})
JOINTTARGET("K90",{-1.042,17.242,-95.103,75.863,56.781,59.753,0.000},{0.000,0.000,0.000,0.000,0.000,0.000,0.000})
ROBTARGET("P10",{900.000,0.000,485.000},{0.000000,0.000000,1.000000,0.000000},{0,0,0,0},{0.000,0.000,0.000,0.000,0.000,0.000,0.000},0.000)
ROBTARGET("P100",{-398.370,344.840,174.830},{0.161227,-0.076252,-0.906489,-0.382714},{-362271,-65536,131070,0},{0.000,0.000,0.000,0.000,0.000,0.000,0.000},0.000)
ROBTARGET("P110",{-329.860,407.370,177.600},{0.160610,-0.076695,-0.907316,-0.380921},{-560753,-65536,131070,0},{0.000,0.000,0.000,0.000,0.000,0.000,0.000},0.000)
ROBTARGET("P20",{1000.000,-100.000,485.000},{0.000000,0.000000,1.000000,0.000000},{0,0,0,0},{0.000,0.000,0.000,0.000,0.000,0.000,0.000},0.000)
ROBTARGET("P30",{1100.000,0.000,485.000},{0.000000,0.000000,1.000000,0.000000},{0,0,0,0},{0.000,0.000,0.000,0.000,0.000,0.000,0.000},0.000)
ROBTARGET("P40",{-335.790,182.930,478.980},{0.585488,-0.018393,-0.717105,-0.377659},{-18228,0,131070,0},{0.000,0.000,0.000,0.000,0.000,0.000,0.000},0.000)
ROBTARGET("P50",{247.900,667.740,746.760},{0.081714,0.374573,0.629687,0.675657},{-2092697,0,65534,0},{0.000,0.000,0.000,0.000,0.000,0.000,0.000},0.000)
ROBTARGET("P60",{375.230,444.780,184.260},{0.191027,0.570806,0.764859,0.229522},{719365,0,-65535,65534},{0.000,0.000,0.000,0.000,0.000,0.000,0.000},0.000)
ROBTARGET("P70",{379.850,290.990,184.270},{0.191072,0.570822,0.764842,0.229502},{434380,0,-131071,65534},{0.000,0.000,0.000,0.000,0.000,0.000,0.000},0.000)
ROBTARGET("P80",{232.430,384.970,184.260},{0.191078,0.570840,0.764829,0.229493},{847740,0,-65535,65534},{0.000,0.000,0.000,0.000,0.000,0.000,0.000},0.000)
ROBTARGET("P90",{264.160,494.170,180.980},{0.190833,0.571024,0.764729,0.229572},{944356,0,-65535,65534},{0.000,0.000,0.000,0.000,0.000,0.000,0.000},0.000)
end
print("The end!")